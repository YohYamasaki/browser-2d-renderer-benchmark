<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>2D renderer benchmarks</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .chart-wrap {
        width: 400px;
        height: 300px;
      }

      #window-wrap {
        border: 2px solid #ddd;
        width: 400px;
        height: 300px;
      }
    </style>
  </head>

  <body>
    <button id="start-tiny-skia">Start tiny-skia benchmark</button>
    <br />

    <div id="window-wrap"></div>

    <div class="chart-wrap">
      <canvas class="chart" id="tiny-skia"></canvas>
    </div>

    <script type="module">
      const tinySkiaEl = document.querySelector("#start-tiny-skia");
      tinySkiaEl.addEventListener("click", () => {
        window.wasmBindings.run_tiny_skia_benchmark();
      });
    </script>

    <script>
      const chartOption = {
        scales: {
          y: {
            min: 0,
            max: 60,
            ticks: {
              stepSize: 10,
            },
          },
        },
      };

      function receiveResults(results, selector) {
        const sortedResults = [...results.entries()].sort(
          (a, b) => a[0] - b[0]
        );
        let labels = [];
        let data = [];

        sortedResults.forEach(([key, value]) => {
          labels.push(key);
          data.push(value);
        });

        const ctx = document.querySelector(selector).getContext("2d");
        const tinySkiaChart = new Chart(ctx, {
          type: "line",
          data: {
            labels,
            datasets: [{ label: "fps", data }],
          },
          options: chartOption,
        });
      }
    </script>
  </body>
</html>
